# 智能职位推荐系统

本项目是一个基于Python和MongoDB的智能职位推荐系统，集成了职位搜索、智能推荐、简历投递和数据分析等功能，为求职者提供个性化的职位推荐服务。

## 目录
- [项目概述](#项目概述)
- [技术栈](#技术栈)
- [系统架构](#系统架构)
- [核心功能](#核心功能)
- [推荐算法详解](#推荐算法详解)
- [数据库设计](#数据库设计)
- [开发环境搭建](#开发环境搭建)
- [使用指南](#使用指南)
- [维护与优化](#维护与优化)
- [系统截图](#系统截图)
- [贡献指南](#贡献指南)
- [维护日志](#维护日志)
- [URL路由说明](#URL路由说明)

## 项目概述

智能职位推荐系统是一个致力于解决求职者与企业精准匹配问题的平台。系统基于用户历史投递行为和求职意向，结合协同过滤和内容匹配算法，为用户提供个性化的职位推荐，同时提供职位搜索、简历投递、职位收藏等功能，以及薪资分布、学历需求等数据分析功能。

### 项目特点

1. **个性化推荐** - 基于用户历史行为和求职意向的智能推荐
2. **多维度搜索** - 支持职位名称、地点、薪资、学历等多维度搜索
3. **数据可视化** - 直观展示职场趋势和薪资分布
4. **用户画像** - 基于用户行为建立用户画像，优化推荐效果
5. **响应式设计** - 适配各种设备屏幕，提供良好的用户体验

## 技术栈

### 后端技术
- **Python 3.x**: 主要开发语言
- **Django 3.1.12**: Web应用框架
  - 提供MVC架构支持
  - 内置用户认证系统
  - 模板引擎渲染
  - 中间件支持

- **MongoDB 4.x**: NoSQL数据库
  - 存储职位数据和用户行为数据
  - 支持复杂的聚合查询
  - 灵活的数据模型
  - 高性能的数据处理

### 前端技术
- **Layui 2.x**: 前端UI框架
  - 模块化开发
  - 响应式布局
  - 丰富的UI组件
  - 高性能数据表格
  - 表单验证

- **jQuery**: JavaScript库
  - DOM操作
  - AJAX请求处理
  - 事件处理

- **ECharts**: 数据可视化库
  - 薪资分布图表
  - 学历需求统计
  - 地区分布热力图

### 推荐算法
- **协同过滤**:
  - 基于物品的协同过滤 (Item-based Collaborative Filtering)
  - 余弦相似度计算
  - 用户偏好分析
  - 混合推荐策略

- **内容匹配**:
  - 关键词匹配
  - 文本相似度分析
  - 职位特征提取

## 系统架构

### 整体架构
```
                           +----------------+
                           |                |
                           |  用户界面层     |
                           |                |
                           +-------+--------+
                                   |
                                   v
+----------------+         +----------------+         +----------------+
|                |         |                |         |                |
| 职位爬虫模块    +-------->+   业务逻辑层    +<--------+  数据分析模块  |
|                |         |                |         |                |
+----------------+         +-------+--------+         +----------------+
                                   |
                                   v
                           +----------------+
                           |                |
                           |   数据存储层    |
                           |                |
                           +----------------+
```

### 模块划分
1. **用户管理模块**
   - 用户注册与登录
   - 用户信息管理
   - 求职意向设置

2. **职位管理模块**
   - 职位列表展示
   - 职位详情查看
   - 职位搜索与筛选

3. **推荐模块**
   - 基于用户画像的推荐
   - 基于行为的协同过滤
   - 基于内容的推荐

4. **投递管理模块**
   - 简历投递
   - 投递记录管理
   - 投递状态跟踪

5. **数据分析模块**
   - 薪资分布分析
   - 学历需求分析
   - 职位趋势分析

## 核心功能

### 1. 职位管理
- **职位列表**：分页展示所有职位，支持多条件筛选
- **职位详情**：展示职位的详细信息，包括职位描述、薪资待遇、工作地点等
- **职位搜索**：支持按职位名称、公司名称、工作地点等条件搜索
- **高级筛选**：支持按薪资范围、学历要求、工作经验等条件筛选

### 2. 智能推荐
- **个性化推荐**：基于用户历史投递记录和求职意向，推荐匹配度高的职位
- **求职意向推荐**：针对用户设置的求职意向，推荐相关职位
- **热门职位推荐**：推荐当前热门的职位
- **混合推荐**：结合多种推荐策略，提供多样化的推荐结果

### 3. 简历投递
- **一键投递**：用户可一键投递简历到感兴趣的职位
- **投递记录**：记录并展示用户的所有投递历史
- **投递状态**：显示投递状态（已投递/已查看/已联系等）
- **取消投递**：允许用户取消已投递的职位

### 4. 用户管理
- **用户注册**：支持用户注册新账号
- **用户登录**：支持用户登录系统
- **个人信息**：用户可以管理个人基本信息
- **求职意向**：用户可以设置求职意向，包括期望职位和工作地点

### 5. 数据分析
- **薪资分析**：展示不同职位、不同地区的薪资分布
- **学历分析**：分析各类职位对学历的要求分布
- **经验分析**：分析各类职位对工作经验的要求
- **地区分析**：分析职位在不同地区的分布情况

## 推荐算法详解

### 推荐流程

1. **获取用户信息**
   - 识别当前用户ID
   - 获取用户基本信息
   - 支持多种ID格式（ObjectId、用户名、user_id）

2. **用户画像构建**
   - 分析用户历史投递记录
   - 提取用户偏好关键词
   - 获取用户最新求职意向

3. **混合推荐策略**
   - **最新意向优先**：根据用户最新设置的求职意向（如Java）推荐相关职位，占60%权重
   - **历史行为考量**：根据用户历史投递记录提取的关键词（如数据分析）推荐相关职位，占40%权重
   - **智能补充**：如果推荐结果不足，从未投递职位中随机补充

4. **相似度计算**
   - 使用余弦相似度计算职位间的相似性
   - 考虑共同投递用户比例
   - 公式：similarity = common_users / sqrt(job1_users * job2_users)

### 算法特点

- **动态权重调整**：最新设置的求职意向具有更高权重
- **冷启动处理**：对于没有投递记录的新用户，基于求职意向或热门职位推荐
- **多维度匹配**：不仅匹配职位关键词，还考虑职位名称、工作地点等因素
- **实时响应**：用户更新求职意向后，推荐结果立即更新
- **多样性保证**：确保推荐结果的多样性，避免过度相似的推荐

### 算法流程图
```
+--------------------+     +--------------------+     +---------------------+
| 用户登录/访问推荐页 +---->+ 获取用户ID和信息   +---->+ 检查是否有投递记录  |
+--------------------+     +--------------------+     +---------+-----------+
                                                                |
                                                                v
                           +--------------------+     +---------------------+
                      +----+ 获取最新求职意向   |<----+ 提取历史投递关键词  |
                      |    +--------------------+     +---------------------+
                      |
                      v
        +-------------+------------+
        |                          |
        v                          v
+-------+--------+      +----------+---------+
| 基于意向推荐(60%) |      | 基于历史行为推荐(40%) |
+----------------+      +--------------------+
        |                          |
        v                          v
        +-------------+------------+
                      |
                      v
        +-------------+------------+
        | 如推荐不足, 随机补充职位 |
        +-------------+------------+
                      |
                      v
        +-------------+------------+
        |    返回推荐结果列表      |
        +-------------+------------+
```

## 数据库设计

### MongoDB集合
1. **job_datas**: 职位信息集合
   - `_id`: ObjectId (职位ID)
   - `name`: String (职位名称)
   - `salary`: String (薪资待遇)
   - `education`: String (学历要求)
   - `experience`: String (经验要求)
   - `place`: String (工作地点)
   - `company`: String (公司名称)
   - `company_type`: String (公司行业)
   - `company_size`: String (公司规模)
   - `href`: String (职位链接)
   - `key_word`: String (职位关键词)
   - `publish_date`: Date (发布日期)

2. **user_list**: 用户信息集合
   - `_id`: ObjectId (用户ID)
   - `username`: String (用户名)
   - `password`: String (密码)
   - `email`: String (邮箱)
   - `phone`: String (手机号)
   - `created_at`: DateTime (注册时间)
   - `last_login`: DateTime (最后登录时间)

3. **user_expect**: 用户意向职位集合
   - `_id`: ObjectId (记录ID)
   - `user_id`: String (用户ID)
   - `key_word`: String (意向职位关键词)
   - `place`: String (意向工作地点)
   - `created_at`: DateTime (创建时间)
   - `updated_at`: DateTime (更新时间)

4. **send_list**: 投递记录集合
   - `_id`: ObjectId (记录ID)
   - `user_id`: String (用户ID)
   - `job_id`: String (职位ID)
   - `created_at`: DateTime (投递时间)
   - `status`: Int (投递状态: 0-已投递, 1-已查看, 2-已联系)

### 数据关系
- 一个用户可以有多个投递记录 (user_list 1:N send_list)
- 一个用户可以有一个求职意向 (user_list 1:1 user_expect)
- 一个职位可以有多个投递记录 (job_datas 1:N send_list)

## 开发环境搭建

### 环境要求
- Python 3.x
- MongoDB 4.x
- Node.js 12+（用于前端资源构建）

### 安装步骤
1. **克隆代码库**
   ```bash
   git clone https://github.com/your-username/job-recommend-system.git
   cd job-recommend-system
   ```

2. **安装Python依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **安装并启动MongoDB**
   ```bash
   # 安装MongoDB (根据操作系统不同，安装方式不同)
   # 启动MongoDB
   mongod --dbpath /path/to/data/db
   ```

4. **初始化数据库**
   ```bash
   python manage.py migrate
   ```

5. **启动开发服务器**
   ```bash
   python manage.py runserver
   ```

6. **访问系统**
   打开浏览器，访问 http://127.0.0.1:8000

## 使用指南

### 用户注册与登录
1. 访问系统首页
2. 点击"注册"按钮，填写注册信息
3. 注册成功后，使用用户名和密码登录

### 职位搜索
1. 登录系统后，进入职位列表页面
2. 在搜索框中输入关键词
3. 使用筛选项（薪资范围、工作地点、学历要求等）进一步筛选
4. 点击搜索按钮，获取搜索结果

### 设置求职意向
1. 登录系统后，进入"我的意向"页面
2. 设置期望职位（如"Java开发"）和期望工作地点（如"北京"）
3. 点击"保存"按钮，保存意向设置

### 查看推荐职位
1. 登录系统后，点击"职位推荐"菜单
2. 系统会根据您的求职意向和历史行为推荐职位
3. 可以点击职位查看详情

### 投递简历
1. 在职位列表或职位详情页，点击"投递简历"按钮
2. 确认投递信息
3. 点击"确定"按钮完成投递

### 查看投递记录
1. 登录系统后，点击"我的投递"菜单
2. 查看所有投递记录和投递状态
3. 可以点击"取消投递"按钮取消已投递的职位

### 查看数据分析
1. 登录系统后，点击"数据分析"菜单
2. 可以查看薪资分布、学历需求、职位热度等数据分析结果

## 维护与优化

### 数据维护
1. **职位数据更新**：定期从招聘网站爬取最新职位数据
2. **数据清洗**：处理重复、无效或过期的职位数据
3. **数据备份**：定期备份数据库，确保数据安全

### 系统优化
1. **性能优化**：
   - 数据库索引优化
   - 查询语句优化
   - 页面加载速度优化
   - 资源压缩与缓存

2. **算法优化**：
   - 推荐算法参数调优
   - 用户画像算法优化
   - 推荐多样性优化
   - 冷启动问题处理

3. **用户体验优化**：
   - 界面交互优化
   - 响应式设计适配
   - 错误处理与提示优化
   - 操作流程简化

### 日常维护
1. 监控系统性能和资源使用情况
2. 处理用户反馈和问题报告
3. 定期检查日志，排查潜在问题
4. 更新系统依赖，修复安全漏洞

## 系统截图

*[此处可添加系统主要页面的截图]*

## 贡献指南

### 提交问题
1. 在GitHub Issues中提交问题
2. 详细描述问题现象和复现步骤
3. 提供系统版本、浏览器版本等环境信息

### 提交代码
1. Fork项目仓库
2. 创建新分支开发新功能或修复问题
3. 提交Pull Request，详细描述变更内容

### 代码规范
1. 遵循PEP 8 Python编码规范
2. 编写单元测试
3. 提供详细的代码注释和文档
4. 确保代码通过所有测试

## 许可证

本项目采用 MIT 许可证，详情请参阅 [LICENSE](LICENSE) 文件。

## 联系方式

- 项目维护者：[Your Name](mailto:your.email@example.com)
- 项目仓库：[GitHub Repository](https://github.com/username/job-recommend-system)
- 问题反馈：[GitHub Issues](https://github.com/username/job-recommend-system/issues)

## 维护日志

### 2024-06-30 数据修复
- **问题**：职位爬虫抓取的实习生岗位的`education`字段错误地保存为时间（如"3个月"），而非教育程度。
- **修复**：创建并执行了`fix_education_experience.py`修复脚本，将实习生岗位的`education`字段统一更正为"本科"，并确保`experience`字段正确标记为"实习"。
- **影响范围**：修复了776条职位记录，主要涉及实习生相关岗位。
- **代码优化**：同时修正了`get_job_list`函数中的搜索参数名称，将`key_word`修改为`keyword`，以匹配前端表单字段。

## 最近修复内容

### 1. 职位分类增强
- 新增实习生分类：修改了`job/keyword_classifier.py`文件，添加实习生关键词识别
- 优化分类逻辑：优先识别实习生职位，确保其在职位分类统计中能够正确显示

### 2. 职位投递与取消功能修复
- 改进了`send_job`函数中投递取消的逻辑：
  - 优先尝试精确匹配删除MongoDB记录
  - 如精确匹配失败，再尝试仅使用job_id删除
  - 详细记录删除流程日志，方便排查问题
  - 无论MongoDB删除是否成功，都保证Django数据库记录被正确删除

### 3. 后台管理删除功能增强
- 重构了`SendListAdmin`类中的删除方法：
  - `delete_model`：处理单条记录删除，先删除Django记录，再删除MongoDB记录
  - `delete_queryset`：处理批量删除，确保两个数据库的记录同步删除
  - 完善错误处理，即使MongoDB删除失败也返回成功信息，避免用户困惑

## 使用说明

### 系统启动
```bash
# 启动Django服务器
python manage.py runserver 0.0.0.0:8000
```

### 爬虫运行
在管理后台或通过API启动爬虫：
```bash
# 手动运行爬虫
python spiders/run_spider.py
```

### 职位分类更新
当需要更新职位分类时执行：
```bash
python job/keyword_classifier.py
```

## 常见问题

### 1. 职位投递记录不同步问题
如果MongoDB和Django数据库中的投递记录不一致，可以通过管理后台手动删除记录，系统会尝试同步删除两个数据库中的记录。

### 2. 实习生分类未显示
请运行职位分类更新脚本：
```bash
python job/keyword_classifier.py
```

### 3. 薪资统计异常
系统支持多种薪资格式，如"10k-20k"、"20k"等。如发现统计异常，请检查原始数据格式。

## 后续优化计划
1. 改进职位推荐算法
2. 添加更多数据可视化图表
3. 优化MongoDB与Django数据同步机制
4. 增强用户交互体验

## URL路由说明

本系统采用Django框架的URL路由机制，所有URL请求都通过`JobRecommend/urls.py`文件中的`urlpatterns`列表进行路由分发。以下是系统中的主要URL路由及其对应功能：

### 用户管理相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/` | `views.login` | - | 默认首页，重定向到登录页 |
| `/login/` | `views.login` | login | 用户登录，支持POST请求提交用户名和密码 |
| `/register/` | `views.register` | register | 用户注册，创建新账户 |
| `/logout/` | `views.logout` | logout | 用户登出，清除会话信息 |
| `/up_info/` | `views.up_info` | up_info | 修改用户个人信息 |

### 主页和导航相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/index/` | `views.index` | index | 系统主页，显示主要功能入口 |
| `/welcome/` | `views.welcome` | welcome | 欢迎页面，展示系统概览信息 |
| `/get_psutil/` | `views.get_psutil` | get_psutil | 获取系统资源使用情况 |

### 职位管理相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/job_list/` | `views.job_list` | job_list | 职位列表页面 |
| `/get_job_list/` | `views.get_job_list` | get_job_list | 获取职位列表数据的API |
| `/get_pie/` | `views.get_pie` | get_pie | 获取职位分布饼图数据 |
| `/send_job/` | `views.send_job` | send_job | 职位投递或取消投递接口 |
| `/job_expect/` | `views.job_expect` | job_expect | 设置求职意向页面及处理 |
| `/get_recommend/` | `views.get_recommend` | get_recommend | 获取职位推荐列表 |
| `/send_list/` | `views.send_list` | send_list | 获取已投递职位列表数据 |
| `/send_page/` | `views.send_page` | send_page | 已投递职位列表页面 |
| `/pass_page/` | `views.pass_page` | pass_page | 已通过职位列表页面 |

### 数据分析相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/salary/` | `views.salary` | salary | 薪资分析页面 |
| `/edu/` | `views.edu` | edu | 学历分析页面 |
| `/bar_page/` | `views.bar_page` | bar_page | 条形图数据可视化页面 |
| `/bar/` | `views.bar` | bar | 获取条形图数据 |
| `/get_salary_top10/` | `views.get_salary_top10` | - | 获取薪资前10的职位数据 |

### 数据可视化相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/word_cloud/` | `views.word_cloud_page` | word_cloud | 职位关键词词云页面 |
| `/get_word_cloud_data/` | `views.get_word_cloud_data` | get_word_cloud_data | 获取词云数据API |
| `/geo_distribution/` | `views.geo_distribution_page` | geo_distribution | 地理分布可视化页面 |
| `/get_geo_distribution_data/` | `views.get_geo_distribution_data` | get_geo_distribution_data | 获取地理分布数据API |
| `/company_scale/` | `views.company_scale_page` | company_scale | 公司规模分析页面 |
| `/get_company_scale_data/` | `views.get_company_scale_data` | get_company_scale_data | 获取公司规模数据API |
| `/experience_analysis/` | `views.experience_analysis_page` | experience_analysis | 工作经验需求分析页面 |
| `/get_experience_data/` | `views.get_experience_data` | get_experience_data | 获取工作经验数据API |

### 爬虫相关路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/spiders/` | `views.spiders` | spiders | 爬虫管理页面 |
| `/start_spider/` | `views.start_spider` | start_spider | 启动爬虫接口 |

### Django内置路由

| URL路径 | 视图函数 | 名称 | 功能描述 |
|--------|---------|------|---------|
| `/admin/` | `admin.site.urls` | - | Django管理后台入口 |

### URL路由工作流程

1. 用户通过浏览器访问系统URL
2. Django接收请求并在`JobRecommend/urls.py`文件中的`urlpatterns`列表中查找匹配的URL模式
3. 找到匹配的URL模式后，Django将调用与之关联的视图函数
4. 视图函数处理请求，可能会:
   - 直接返回HTML响应(通过`render`函数)
   - 返回JSON数据(通过`JsonResponse`)
   - 重定向到其他URL(通过`redirect`函数)
   - 返回错误响应

### URL命名空间

系统使用Django的URL命名功能(通过`name`参数)，可以在模板中通过`{% url 'name' %}`方式引用URL，避免硬编码URL路径，便于后期维护和修改。

### URL参数传递

部分URL支持通过以下方式传递参数:
1. **查询字符串参数**: 如`/get_job_list/?page=1&limit=10`
2. **POST请求参数**: 如登录表单提交用户名和密码
3. **路径参数**: Django支持的路径参数方式(示例中未使用) 